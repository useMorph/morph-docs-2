---
title: "PostgreSQL"
icon: "database"
---

## Connecting to PostgreSQL

<Tabs>
  <Tab title="Cloud">
    <Steps>
      <Step title="Create an SQL Connection">
        From the "Data" tab in the workspace, select "SQL Connection" and click the "Create" button.
        <img src="/assets/images/docs/connect-data-platform-connection.png" alt="Connection" />
      </Step>

      <Step title="Enter PostgreSQL Credentials">
        Fill in the database credentials in the displayed form. If connecting via a remote server, check the "SSH" box and provide the optional parameters.

        After entering the details, click the Create button to complete the setup. If there are any errors in the parameters, an error message will be displayed. Please verify the connection details.

        <img src="/assets/images/docs/connect-data-platform-postgresql-create.png" alt="PostgreSQL Connection Create" />

        | Field Name        | Description                              | Required | Example                       |
        |-------------------|------------------------------------------|----------|-------------------------------|
        | `Host`           | Enter the database host name.            | âœ…        | `example.com`                |
        | `Port`           | Enter the database connection port.      | âœ…        | `5432`                       |
        | `Database`       | Enter the database name.                 | âœ…        | `my_database`                |
        | `Username`       | Enter the database username.             | âœ…        | `db_user`                    |
        | `Password`       | Enter the database user's password.      | âœ…        | `mypassword`                 |
        | `SSH`            | Specify if using SSH connection.         |         |                               |
        | `SSH Host`       | Enter the remote server host name.       |         | `ssh.example.com`            |
        | `SSH Port`       | Enter the remote server connection port. |         | `22`                         |
        | `SSH Username`   | Enter the remote server username.        |         | `ssh_user`                   |
        | `SSH Password`   | Enter the remote server user's password. |         | `sshpassword`                |
        | `SSH Private Key`| Enter the remote server private key.     |         | `-----BEGIN RSA PRIVATE KEY-----` |
        | `SSH Passphrase` | Enter the private key passphrase.        |         | `my_passphrase`              |


        <Warning>Ensure that the IP whitelist of the target database allows access from `54.150.149.0/32`.</Warning>

      </Step>
      <Step title="Connect to the Created Database">
        Once successfully created, you can find the connection name in the list view. The string next to the icon is `connection_name`. Use this name to connect to the database in your code.

        <img src="/assets/images/docs/connect-data-platform-postgresql-complete.png" alt="PostgreSQL Connection Create Complete" />

        Enter the created connection name in SQL or Python code to retrieve data.
        <CodeGroup>
        ```sql SQL
        {{
            config(
                connection="connection_name"
            )
        }}

        select * from table_name
        ```

        ```python Python
        import morph
        from morph import MorphGlobalContext
        from morph_lib.database import execute_sql


        @morph.func
        def main(context: MorphGlobalContext):
            df = execute_sql(
                sql="SELECT * from table_name"
                connection="connection_name"
            )
            return df
        ```
        </CodeGroup>
      </Step>
    </Steps>

  </Tab>
  <Tab title="Local">
    <Steps>
      <Step title="Run the `morph init` Command">
        Run the `morph init` command to save the database connection information in `~/.morph/connections.yaml`.
        ```bash Shell
        morph init
        ```

        <Warning>
        If the `morph` package is not installed, install it with the following command before proceeding:
        ```bash shell
        pip install morph-data
        ```
        </Warning>

        An interactive interface will ask you to select the type of database to input credentials for. Select PostgreSQL.
        ```bash Shell
        Select your database type:
        1. PostgreSQL
        2. MySQL
        3. Redshift
        4. SQLServer
        5. Snowflake (User/Password)
        6. BigQuery (Service Account)
        Enter the number corresponding to your database type: 1

        PostgreSQL selected.
        ```

        Next, enter the database credentials. The `slug` acts as the connection name, which will be specified in SQL or Python code.

        Replace the following example inputs with actual values for your database connection:
        ```bash shell
        Create a slug for your connection: postgresql-connection
        Enter your PostgreSQL host (default: localhost): localhost
        Enter your PostgreSQL username: your_user_name
        Enter your PostgreSQL password: your_password
        Enter your PostgreSQL port (default: 5432): 5432
        Enter your PostgreSQL database name: your_database_name
        Enter your PostgreSQL schema name (default: public): public
        Select if you are using SSH tunneling (y/n): n
        ```

        Once the credentials are saved, the following message will be displayed:
        ```bash shell
        Successfully initialized! ðŸŽ‰
        You can edit your connection details in `path_to_connections.yaml`
        ```
      </Step>
      <Step title="Use the Connection in Code to Retrieve Data">
        Enter the created connection name in SQL or Python code to retrieve data.
        <CodeGroup>
        ```sql SQL
        {{
            config(
                connection="connection_name"
            )
        }}

        select * from table_name
        ```

        ```python Python
        import morph
        from morph import MorphGlobalContext
        from morph_lib.database import execute_sql


        @morph.func
        def main(context: MorphGlobalContext):
            df = execute_sql(
                sql="SELECT * from table_name"
                connection="connection_name"
            )
            return df
        ```
        </CodeGroup>
      </Step>
    </Steps>

  </Tab>  
</Tabs>
